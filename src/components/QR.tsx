import React from 'react';
import { Image } from 'react-bootstrap';
import generateQR from '../utils/qr-genarator';

type QRState = {
  dataURL: string;
};
type QRProps = {
  text: string;
};

const defaultImage =
  'data:image/png;base64,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';
class QR extends React.Component<QRProps, QRState> {
  constructor(props: QRProps) {
    super(props);
    this.state = { dataURL: null };
  }

  async componentDidUpdate(previousProps: QRProps) {
    const { text } = this.props;
    if (text && previousProps.text !== text) {
      // eslint-disable-next-line react/no-did-update-set-state
      this.setState({ dataURL: await generateQR(text) });
    }
  }

  render() {
    const { dataURL } = this.state;
    const opacity = dataURL ? 1 : 0.5;
    return (
      <Image alt="QR Code" src={dataURL || defaultImage} style={{ opacity }} />
    );
  }
}

export default QR;
